define(["jquery","core/str","core/modal_factory","core/modal_events","core/templates","core/ajax","core/fragment","core/notification"],function(a,b,c,d,e,f,g,h){function i(){var a={},b={jsonformdata:JSON.stringify(a)};l.setBody(n),l.setBody(g.loadFragment("tool_trigger","new_import_form",k,b))}function j(a){a.preventDefault();var c=l.getRoot().find("form").serialize();l.setBody(n),f.call([{methodname:"tool_trigger_process_import_form",args:{jsonformdata:JSON.stringify(c)}}])[0].done(function(a){var b=JSON.parse(a);"success"==b.errorcode?location.reload(!0):Object.keys(b.message).forEach(function(a){h.addNotification({message:b.message[a],type:"error"})}),l.hide()}).fail(function(){h.addNotification({message:b.get_string("errorimportworkflow","tool_trigger"),type:"error"}),l.hide()})}var k,l,m={},n='<p class="text-center"><i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i><span class="sr-only">Loading...</span></p>';return m.init=function(e){k=e,b.get_string("importmodaltitle","tool_trigger").then(function(b){c.create({type:c.types.SAVE_CANCEL,title:b,body:n,large:!0},a("[name=importbtn]")).done(function(a){l=a,l.getRoot().on(d.save,j),l.getRoot().on(d.hidden,i),i()})})},m});